承知しました。お返しコンシェルジュBOTのWebUI実装に向けた計画書を作成させていただきます。

まず、現在の実装状況を確認させていただきます。

Ran tool

Ran tool


以下に、WebUI実装に向けた計画書を作成いたします：

# お返しコンシェルジュBOT WebUI実装計画書

## 1. 技術スタック

### フロントエンド
- **フレームワーク**: Next.js
- **スタイリング**: TailwindCSS
- **状態管理**: React Query
- **TypeScript**を採用

### バックエンド
- **既存のRustバックエンド**を活用
- WebSocket対応のため`tokio-tungstenite`を追加
- RESTful APIの実装に`axum`を使用

## 2. システム構成

```
Client (Next.js) <-> API Gateway <-> Rust Backend
                                    ├── チャットボット
                                    ├── ギフト推薦エンジン
                                    └── データベース
```

## 3. 実装フェーズ

### Phase 1: バックエンドAPI実装（2日間）
1. RESTful APIエンドポイントの実装
   - `/api/chat` - チャットメッセージの送受信
   - `/api/recommendations` - ギフト推薦結果の取得
   - `/api/history` - 会話履歴の取得

2. WebSocket対応
   - リアルタイムメッセージング機能の実装
   - 接続管理とエラーハンドリング

### Phase 2: フロントエンド基盤構築（2日間）
1. Next.jsプロジェクトのセットアップ
2. TailwindCSSの設定
3. 基本レイアウトの実装
   - ヘッダー
   - フッター
   - チャットコンテナ

### Phase 3: チャットUI実装（3日間）
1. メッセージ入力フォーム
2. チャットメッセージ表示
   - メッセージバブル
   - タイピングインジケーター
   - 送信状態表示
3. ギフト推薦結果の表示
   - カード形式での表示
   - 詳細情報モーダル

### Phase 4: 機能拡張（2日間）
1. 会話履歴管理
2. エラーハンドリング
3. ローディング状態の実装
4. レスポンシブデザイン対応

### Phase 5: テストと最適化（2日間）
1. ユニットテスト
2. E2Eテスト
3. パフォーマンス最適化
4. アクセシビリティ対応

## 4. 具体的なUI/UX設計

### チャットインターフェース
- チャットウィンドウは画面中央に配置
- メッセージ入力欄は画面下部に固定
- ユーザーメッセージは右側、ボットメッセージは左側に表示
- タイピングインジケーターでボットの応答待ち表示

### ギフト推薦表示
- カード形式でギフト候補を表示
- 各カードには：
  - 商品画像
  - 商品名
  - 価格
  - 簡単な説明
  - 「詳細を見る」ボタン

## 5. 技術的な注意点

1. **状態管理**
   - WebSocketの接続状態管理
   - チャット履歴のキャッシュ管理
   - エラー状態の適切な処理

2. **パフォーマンス**
   - メッセージの遅延読み込み
   - 画像の最適化
   - キャッシュ戦略の実装

3. **セキュリティ**
   - CSRF対策
   - XSS対策
   - レート制限の実装

## 6. 開発環境セットアップ手順

1. フロントエンド環境構築
```bash
# Next.jsプロジェクトの作成
npx create-next-app@latest gift-advisor-frontend --typescript --tailwind

# 必要なパッケージのインストール
npm install @tanstack/react-query axios socket.io-client
```

2. バックエンド環境更新
```bash
# 必要なクレートの追加
cargo add axum
cargo add tokio-tungstenite
cargo add tower-http
```

